
> react-app-boilerplate@0.0.0 test
> jest
 PASS   service  src/service/data/GeminiImageGeneratorExtraction.test.ts
 PASS   client  src/client/test/ListingGenerationUI.test.tsx
 PASS   client  src/client/hooks/useProductUpload.test.ts
  â— Console
    console.error
      An update to TestComponent inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
 PASS   service  src/service/repositories/ListingRepositoryFallback.test.ts
  â— Console
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      API overloaded/rate-limited (status 503). Retrying in 5s...
      at runGeneration (src/service/repositories/ListingRepository.ts:190:21)
          at async Promise.all (index 0)
    console.log
      API overloaded/rate-limited (status 503). Retrying in 10s...
      at runGeneration (src/service/repositories/ListingRepository.ts:190:21)
          at async Promise.all (index 0)
    console.log
      Model gemini-2.5-flash-image failed with retryable error. Trying next model imagen-4.0-generate-001...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: imagen-4.0-generate-001
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'imagen-4.0-generate-001',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Model gemini-2.5-flash-image failed with retryable error. Trying next model imagen-4.0-generate-001...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: imagen-4.0-generate-001
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'imagen-4.0-generate-001',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Model imagen-4.0-generate-001 failed with retryable error. Trying next model gemini-1.5-flash-latest...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: gemini-1.5-flash-latest
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-1.5-flash-latest',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Model gemini-2.5-flash-image failed with retryable error. Trying next model imagen-4.0-generate-001...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: imagen-4.0-generate-001
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'imagen-4.0-generate-001',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Model imagen-4.0-generate-001 failed with retryable error. Trying next model gemini-1.5-flash-latest...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: gemini-1.5-flash-latest
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-1.5-flash-latest',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Model gemini-2.5-flash-image failed with retryable error. Trying next model imagen-4.0-generate-001...
      at Object.generateImages (src/service/repositories/ListingRepository.ts:57:19)
    console.log
      Attempting generation with model: imagen-4.0-generate-001
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'imagen-4.0-generate-001',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
 PASS   client  src/client/repositories/ListingRepository.test.ts
 PASS   service  src/service/test/integration/GenerateListingImagesError.test.ts
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: ðŸ” prevent building .env in docker: https://dotenvx.com/prebuild
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Incoming request: POST /listings/generate
      at src/service/app.ts:17:11
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 0,
        hero: 0,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      POST /listings/generate - 200 - 27ms
      at src/service/app.ts:20:11
 PASS   service  src/service/test/ContextTemplateRepository.test.ts
 PASS   service  src/service/test/integration/PromptPreview.test.ts
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: ðŸ“¡ add observability to secrets: https://dotenvx.com/ops
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Incoming request: POST /listings/system-prompt
      at src/service/app.ts:17:11
    console.log
      POST /listings/system-prompt - 200 - 30ms
      at src/service/app.ts:20:11
    console.log
      Incoming request: POST /listings/system-prompt
      at src/service/app.ts:17:11
    console.log
      POST /listings/system-prompt - 200 - 0ms
      at src/service/app.ts:20:11
    console.log
      Incoming request: POST /listings/system-prompt
      at src/service/app.ts:17:11
    console.log
      POST /listings/system-prompt - 200 - 0ms
      at src/service/app.ts:20:11
    console.log
      Incoming request: GET /listings/system-prompt
      at src/service/app.ts:17:11
    console.log
      GET /listings/system-prompt - 405 - 0ms
      at src/service/app.ts:20:11
 PASS   service  src/service/repositories/ListingRepository.test.ts
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: 1,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: true
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 0,
        hero: 0,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: false
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
 PASS   service  src/service/test/ListingController.test.ts
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: âš™ï¸  override existing env vars with { override: true }
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Incoming request: GET /listings/templates
      at src/service/app.ts:17:11
    console.log
      GET /listings/templates - 200 - 2ms
      at src/service/app.ts:20:11
    console.log
      Incoming request: POST /listings/templates
      at src/service/app.ts:17:11
    console.log
      POST /listings/templates - 201 - 7ms
      at src/service/app.ts:20:11
 PASS   client  src/client/hooks/useListingGeneration.test.ts
  â— Console
    console.log
      Generation failed for model: gemini-2.5-flash-image Server Error (503): Service Unavailable
      at Object.generateListing (src/client/hooks/useListingGeneration.ts:74:17)
    console.log
      Generation failed for model: gemini-2.5-flash-image Something went wrong
      at Object.generateListing (src/client/hooks/useListingGeneration.ts:74:17)
    console.log
      Generation failed for model: gemini-2.5-flash-image Something went wrong
      at Object.generateListing (src/client/hooks/useListingGeneration.ts:74:17)
    console.log
      Generation failed for model: gemini-2.5-flash-image 503 Service Unavailable
      at Object.generateListing (src/client/hooks/useListingGeneration.ts:74:17)
    console.log
      Generation failed for model: gemini-2.5-flash-image Internal Server Error
      at Object.generateListing (src/client/hooks/useListingGeneration.ts:74:17)
 PASS   client  src/client/test/ProductUpload.test.tsx
  â— Console
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      32 |     if (repository) {
      33 |       repository.getTemplates().then((response: { templates: ContextTemplate[] }) => {
    > 34 |         setTemplates(response.templates || []);
         |         ^
      35 |       });
      36 |     }
      37 |   }, [repository]);
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useProductUpload.ts:34:9
    console.error
      An update to App inside a test was not wrapped in act(...).

      When testing, code that causes React state updates should be wrapped into act(...):

      act(() => {
        /* fire events that update state */
      });
      /* assert on the output */

      This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act
      153 |       try {
      154 |         const response = await listingRepository.getSystemPromptPreview(params);
    > 155 |         setSystemPrompt(response.systemPrompt || '');
          |         ^
      156 |       } catch (err) {
      157 |         console.error('Failed to fetch prompt preview:', err);
      158 |       }
      at node_modules/react-dom/cjs/react-dom-client.development.js:18758:19
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at warnIfUpdatesNotWrappedWithActDEV (node_modules/react-dom/cjs/react-dom-client.development.js:18757:9)
      at scheduleUpdateOnFiber (node_modules/react-dom/cjs/react-dom-client.development.js:16409:11)
      at dispatchSetStateInternal (node_modules/react-dom/cjs/react-dom-client.development.js:9170:13)
      at dispatchSetState (node_modules/react-dom/cjs/react-dom-client.development.js:9127:7)
      at src/client/hooks/useListingGeneration.ts:155:9
 PASS   service  src/service/test/integration/GeminiImageGenerator.test.ts (23.227 s)
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: ðŸ” prevent committing .env to code: https://dotenvx.com/precommit
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Incoming request: POST /listings/generate
      at src/service/app.ts:17:11
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: 0,
        closeUps: 0,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: true
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      POST /listings/generate - 200 - 21945ms
      at src/service/app.ts:20:11
 PASS   service  src/service/test/integration/FourLifestyleShots.test.ts (23.873 s)
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: âš™ï¸  load multiple .env files with { path: ['.env.local', '.env'] }
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Incoming request: POST /listings/generate
      at src/service/app.ts:17:11
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 4,
        hero: 0,
        closeUps: 0,
        flatLay: 0,
        macro: 0,
        contextual: 0,
        model: 'gemini-2.5-flash-image',
        hasProductImage: true
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      POST /listings/generate - 200 - 22590ms
      at src/service/app.ts:20:11
 PASS   service  src/service/commands/GenerateListingImages.test.ts (27.818 s)
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: âš™ï¸  specify custom .env file path with { path: '/custom/path/.env' }
      at _log (node_modules/dotenv/lib/main.js:142:11)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: 1,
        hero: undefined,
        closeUps: undefined,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: true
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
    console.log
      Attempting generation with model: gemini-2.5-flash-image
      at Object.generateImages (src/service/repositories/ListingRepository.ts:43:17)
    console.log
      Generating images with params: {
        lifestyle: undefined,
        hero: undefined,
        closeUps: 1,
        flatLay: undefined,
        macro: undefined,
        contextual: undefined,
        model: 'gemini-2.5-flash-image',
        hasProductImage: true
      }
      at internalGenerateImages (src/service/repositories/ListingRepository.ts:122:13)
 PASS   service  src/service/data/GeminiImageGenerator.test.ts (29.029 s)
  â— Console
    console.log
      [dotenv@17.2.3] injecting env (1) from .env -- tip: âš™ï¸  suppress all logs with { quiet: true }
      at _log (node_modules/dotenv/lib/main.js:142:11)
Test Suites: 16 passed, 16 total
Tests:       68 passed, 68 total
Snapshots:   0 total
Time:        29.795 s
Ran all test suites in 2 projects.
